{"entries":[{"timestamp":1771759749461,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":3894,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <variables></variables>\n  <block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":1493,"diffs":[[1," "]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":175,"length1":94,"diffs":[[1,"        \"assets.json\"\n"]]},{"start1":204,"length1":35,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"physics.ts","value":"//% color=\"#268388\" icon=\"\\uf110\" block=\"Rampas\"\nnamespace rampas {\n    let spritesRampa: Sprite[] = [];\n    let rampaTiles: Image[] = [];\n\n    /**\n     * Define qué imágenes de tiles se comportarán como rampas (/)\n     */\n    //% block=\"configurar tiles de rampa %tiles\"\n    //% tiles.shadow=tilemap_tiles\n    export function setRamps(tiles: Image[]) {\n        rampaTiles = tiles;\n    }\n\n    /**\n     * Activa el sistema para un sprite\n     */\n    //% block=\"habilitar física de rampa para %sprite=variables_get(mySprite)\"\n    export function habilitar(sprite: Sprite) {\n        if (spritesRampa.indexOf(sprite) == -1) {\n            spritesRampa.push(sprite);\n        }\n    }\n\n    game.onUpdate(function () {\n        for (let s of spritesRampa) {\n            // Ubicación de los pies del sprite\n            let tileX = Math.floor(s.x / 16);\n            let tileY = Math.floor((s.bottom + 1) / 16);\n            let currentTile = tiles.getTileAt(tileX, tileY);\n\n            // Comprobar si el tile bajo los pies está en nuestra lista de rampas\n            let esRampa = false;\n            for (let img of rampaTiles) {\n                if (currentTile.equals(img)) {\n                    esRampa = true;\n                    break;\n                }\n            }\n\n            if (esRampa) {\n                // Cálculo de la altura: xRelativo va de 0 a 15\n                let xRelativo = s.x % 16;\n                // Para rampa de subida (/): cuanto más a la derecha (X alto), más arriba (Y bajo)\n                let alturaDeseada = 16 - xRelativo;\n                let ySuelo = (tileY * 16) + alturaDeseada;\n\n                // Solo \"levita\" si el sprite está cayendo sobre la rampa\n                if (s.bottom >= ySuelo - 2) {\n                    s.bottom = ySuelo;\n                    if (s.vy > 0) s.vy = 0; // Detener caída\n                }\n            }\n        }\n    });\n}\n"},{"type":"added","filename":"tilemap.g.jres","value":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAA8AAAAAAAAAD/AAAAAAAA8P8AAAAAAAD//wAAAAAA8P//AAAAAAD///8AAAAA8P///wAAAAD/////AAAA8P////8AAAD//////wAA8P//////AAD///////8A8P///////wD/////////8P///////////////////w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico\"\n    },\n    \"ejemplo_rampa1\": {\n        \"id\": \"ejemplo_rampa1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMTAwMDAwMDAwMDAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMjIyMjIyMjIyMjIyMjIyMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMA==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"sprites.castle.tilePath2\",\n            \"myTiles.tile1\"\n        ],\n        \"displayName\": \"ejemplo_rampa\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}"},{"type":"added","filename":"tilemap.g.ts","value":"// Código generado automáticamente. No editar.\nnamespace myTiles {\n    //% fixedInstance jres blockIdentity=images._tile\n    export const transparency16 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile1 = image.ofBuffer(hex``);\n\n    helpers._registerFactory(\"tilemap\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"ejemplo_rampa\":\n            case \"ejemplo_rampa1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000000000001010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . 2 . . . . . . \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n`, [myTiles.transparency16,sprites.castle.tilePath2,myTiles.tile1], TileScale.Sixteen);\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"tile\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"transparency16\":return transparency16;\n            case \"miMosaico\":\n            case \"tile1\":return tile1;\n        }\n        return null;\n    })\n\n}\n// Código generado automáticamente. No editar.\n"}]},{"timestamp":1771760275885,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":2124,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"rU0gkrmDG-h~ZV(78K|-\">personaje</variable><variable type=\"KIND_SpriteKind\" id=\"-xND-uyUYO}#r%#D(~.l\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"byis~Sr{`I^eXLuD:Xed\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"*kny.FSU/+G]{OB[L63B\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"I|kFG8~oo=e7F^p14h=V\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"20\" y=\"20\"><statement name=\"HANDLER\"><block type=\"set_current_tilemap\"><comment pinned=\"false\" h=\"80\" w=\"160\">--- EJEMPLO DE USO (CÓDIGO DEL JUEGO) ---\n1. Crear un mapa pequeño con una rampa\nNota: Debes dibujar una rampa en el tilemap y ponerle \"MURO\"</comment><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`ejemplo_rampa`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"ejemplo_rampa1\"}}</data></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"rU0gkrmDG-h~ZV(78K|-\">personaje</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Crear al jugador</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n. . . . . . f f f f . . . . . . \n. . . . f f f 2 2 f f f . . . . \n. . . f f f 2 2 2 2 f f f . . . \n. . f f f e e e e e e f f f . . \n. . f f e 2 2 2 2 2 2 e e f . . \n. . f e 2 f f f f f f 2 e f . . \n. . f f f f f f f f f f f f . . \n. . f f d d d d d d d d f f . . \n. . . f d d d d d d d d f . . . \n. . . f d d d d d d d d f . . . \n. . . f f f f f f f f f f . . . \n. . . . f f . . . . f f . . . . \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><comment pinned=\"false\" h=\"80\" w=\"160\">3. Aplicar controles y gravedad</comment><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"rU0gkrmDG-h~ZV(78K|-\">personaje</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><comment pinned=\"false\" h=\"80\" w=\"160\">Gravedad</comment><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"rU0gkrmDG-h~ZV(78K|-\">personaje</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"rU0gkrmDG-h~ZV(78K|-\">personaje</field></block></value><next><block type=\"rampas_setRamps\"><value name=\"tiles\"><shadow xmlns=\"http://www.w3.org/1999/xhtml\" type=\"tilemap_tiles\"></shadow><block type=\"lists_create_with\"><mutation items=\"1\" horizontalafter=\"3\"></mutation><value name=\"ADD0\"><block type=\"screen_image_picker\"><field name=\"img\">img`\n. . . . . . . . . . . . . . . f \n. . . . . . . . . . . . . . f f \n. . . . . . . . . . . . . f f f \n. . . . . . . . . . . . f f f f \n. . . . . . . . . . . f f f f f \n. . . . . . . . . . f f f f f f \n. . . . . . . . . f f f f f f f \n. . . . . . . . f f f f f f f f \n. . . . . . . f f f f f f f f f \n. . . . . . f f f f f f f f f f \n. . . . . f f f f f f f f f f f \n. . . . f f f f f f f f f f f f \n. . . f f f f f f f f f f f f f \n. . f f f f f f f f f f f f f f \n. f f f f f f f f f f f f f f f \nf f f f f f f f f f f f f f f f \n`</field></block></value></block></value></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":685,"diffs":[[1,"// --- EJEMPLO DE USO (CÓDIGO DEL JUEGO) ---\n// 1. Crear un mapa pequeño con una rampa\n// Nota: Debes dibujar una rampa en el tilemap y ponerle \"MURO\"\ntiles.setCurrentTilemap(tilemap`ejemplo_rampa`)\n// 2. Crear al jugador\nlet personaje = sprites.create(img`\n    . . . . . . f f f f . . . . . . \n    . . . . f f f 2 2 f f f . . . . \n    . . . f f f 2 2 2 2 f f f . . . \n    . . f f f e e e e e e f f f . . \n    . . f f e 2 2 2 2 2 2 e e f . . \n    . . f e 2 f f f f f f 2 e f . . \n    . . f f f f f f f f f f f f . . \n    . . f f d d d d d d d d f f . . \n    . . . f d d d d d d d d f . . . \n    . . . f d d d d d d d d f . . . \n    . . . f f f f f f f f f f . . . \n    . . . . f f . . . . f f . . . . \n    `, SpriteKind.Player)\n// 3. Aplicar controles y gravedad\ncontroller.moveSprite(personaje, 100, 0)\n// Gravedad\npersonaje.ay = 350\nscene.cameraFollowSprite(personaje)\nrampas.setRamps([img`\n    . . . . . . . . . . . . . . . f \n    . . . . . . . . . . . . . . f f \n    . . . . . . . . . . . . . f f f \n    . . . . . . . . . . . . f f f f \n    . . . . . . . . . . . f f f f f \n    . . . . . . . . . . f f f f f f \n    . . . . . . . . . f f f f f f f \n    . . . . . . . . f f f f f f f f \n    . . . . . . . f f f f f f f f f \n    . . . . . . f f f f f f f f f f \n    . . . . . f f f f f f f f f f f \n    . . . . f f f f f f f f f f f f \n    . . . f f f f f f f f f f f f f \n    . . f f f f f f f f f f f f f f \n    . f f f f f f f f f f f f f f f \n    f f f f f f f f f f f f f f f f \n    `])\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":276,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]},{"type":"edited","filename":"physics.ts","patch":[{"start1":0,"length1":52,"diffs":[[1,"//% color=\"#268388\" icon=\"\\uf110\" block=\"Rampas\"\n"]]},{"start1":68,"length1":70,"diffs":[[1,"    let spritesRampa: Sprite[] = [];\n    let rampaTiles: Image[] = [];\n"]]},{"start1":148,"length1":61,"diffs":[[1,"     * Define qué imágenes de tiles se comportarán como rampas (/)\n"]]},{"start1":223,"length1":128,"diffs":[[1,"    //% block=\"configurar tiles de rampa %tiles\"\n    //% tiles.shadow=tilemap_tiles\n    export function setRamps(tiles: Image[]) {\n        rampaTiles = tiles;\n"]]},{"start1":397,"length1":39,"diffs":[[1,"     * Activa el sistema para un sprite\n"]]},{"start1":445,"length1":200,"diffs":[[1,"    //% block=\"habilitar física de rampa para %sprite=variables_get(mySprite)\"\n    export function habilitar(sprite: Sprite) {\n        if (spritesRampa.indexOf(sprite) == -1) {\n            spritesRampa.push(sprite);\n"]]},{"start1":678,"length1":59,"diffs":[[1,""]]},{"start1":710,"length1":32,"diffs":[[1,"        for (let s of spritesRampa) {\n            // Ubicación de los pies del sprite\n            let tileX = Math.floor(s.x / 16);\n            let tileY = Math.floor((s.bottom + 1) / 16);\n            let currentTile = tiles.getTileAt(tileX, tileY);\n"]]},{"start1":961,"length1":264,"diffs":[[1,"            // Comprobar si el tile bajo los pies está en nuestra lista de rampas\n            let esRampa = false;\n            for (let img of rampaTiles) {\n                if (currentTile.equals(img)) {\n                    esRampa = true;\n                    break;\n                }\n            }\n"]]},{"start1":1261,"length1":255,"diffs":[[1,"            if (esRampa) {\n                // Cálculo de la altura: xRelativo va de 0 a 15\n                let xRelativo = s.x % 16;\n                // Para rampa de subida (/): cuanto más a la derecha (X alto), más arriba (Y bajo)\n                let alturaDeseada = 16 - xRelativo;\n                let ySuelo = (tileY * 16) + alturaDeseada;\n"]]},{"start1":1605,"length1":500,"diffs":[[1,"                // Solo \"levita\" si el sprite está cayendo sobre la rampa\n                if (s.bottom >= ySuelo - 2) {\n                    s.bottom = ySuelo;\n                    if (s.vy > 0) s.vy = 0; // Detener caída\n"]]},{"start1":1867,"length1":7,"diffs":[[1,"    });\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1981,"length1":1325,"diffs":[[1,""]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":1632,"length1":1228,"diffs":[[1,""]]}]}]},{"timestamp":1771760844441,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":3950,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"*0kaI5%1wcStO4z0cxJm\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"Wk5?5u#`~6K!5Qm4wSE9\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"!Z_H}UGPt;`,3Fc![rc5\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"jZw`4v!7/Y[z2{_141:Q\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"tP[X8%C`7M{lS3[TIiRy\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"20\" y=\"20\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"*0kaI5%1wcStO4z0cxJm\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"*0kaI5%1wcStO4z0cxJm\">mySprite</field></block></value><next><block type=\"rampas_activar\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"*0kaI5%1wcStO4z0cxJm\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value></block></next></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":841,"diffs":[[1,"let mySprite = sprites.create(img`\n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n`, SpriteKind.Player)\n"]]},{"start1":620,"length1":99,"diffs":[[1,""]]},{"start1":645,"length1":28,"diffs":[[1,"tiles.setCurrentTilemap(tilemap`nivel1`)"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":276,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]},{"type":"edited","filename":"physics.ts","patch":[{"start1":0,"length1":54,"diffs":[[1,"//% color=\"#268388\" icon=\"\\uf110\" block=\"RampasPro\"\n"]]},{"start1":71,"length1":32,"diffs":[[1,"    let listaSprites: Sprite[] = [];\n    let rampaTile: Image = null;\n"]]},{"start1":150,"length1":52,"diffs":[[1,"     * Define la imagen exacta del tile que es una rampa (/)\n"]]},{"start1":219,"length1":78,"diffs":[[1,"    //% block=\"configurar tile de rampa %img=tilemap_tiles\"\n    export function setRampa(img: Image) {\n        rampaTile = img;\n    }\n\n    /**\n     * Activa la física para el sprite\n     */\n    //% block=\"activar rampa en %sprite=variables_get(mySprite)\"\n"]]},{"start1":520,"length1":26,"diffs":[[1,"        if (listaSprites.indexOf(sprite) == -1) {\n            listaSprites.push(sprite);\n        }\n"]]},{"start1":626,"length1":0,"diffs":[[1,"    // Usamos el evento estándar de actualización de juego\n"]]},{"start1":717,"length1":30,"diffs":[[1,"        if (!rampaTile) return;\n"]]},{"start1":750,"length1":213,"diffs":[[1,"        for (let s of listaSprites) {\n            // 1. Detectar el tile justo debajo de los pies (centro del sprite)\n            let col = Math.floor(s.x / 16);\n            let row = Math.floor((s.bottom + 1) / 16);\n            let t = tiles.getTileAt(col, row);\n"]]},{"start1":1015,"length1":86,"diffs":[[1,"            // 2. Si el tile coincide con nuestra imagen de rampa\n            if (t == rampaTile) {\n                // 3. Calcular posición X relativa dentro del tile (0 a 15)\n                let xRel = s.x % 16;\n                if (xRel < 0) xRel += 16;\n"]]},{"start1":1271,"length1":239,"diffs":[[1,"                // 4. Ecuación de rampa de subida (/)\n                // A más X, menos Y (más altura)\n                let ySueloLocal = 16 - xRel;\n                let ySueloGlobal = (row * 16) + ySueloLocal;\n"]]},{"start1":1481,"length1":282,"diffs":[[1,"                // 5. Ajustar el sprite para que \"levite\" exactamente en la pendiente\n                if (s.bottom >= ySueloGlobal - 4) {\n                    s.bottom = ySueloGlobal;\n                    // Neutralizar gravedad para que no rebote\n                    if (s.vy > 0) s.vy = 0;\n"]]},{"start1":1803,"length1":470,"diffs":[[1,""]]}]}]},{"timestamp":1771761444159,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":778,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"Tf~z_1_;_}*1%qa#jDSJ\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"l56R9So_}K9gu5v{qc]v\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"?kCK}zns~~pDoMnErR_j\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"$HoLRvY@trz7xW+/iC.J\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"18\" y=\"31\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n"]]},{"start1":1308,"length1":2644,"diffs":[[1,"`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"rampas_activar\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"keyonevent\" x=\"864\" y=\"0\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-150</field></shadow></value></block></statement></block></statement></block></xml>"]]}]},{"type":"edited","filename":"physics.ts","patch":[{"start1":0,"length1":57,"diffs":[[1,"//% color=\"#268388\" icon=\"\\uf110\" block=\"RampasPixel\"\n"]]},{"start1":73,"length1":26,"diffs":[[1,"    let _jugador: Sprite = null\n"]]},{"start1":114,"length1":112,"diffs":[[1,"     * Activa la detección por píxel para un sprite\n"]]},{"start1":174,"length1":67,"diffs":[[1,"    //% block=\"activar rampa de precisión en %sprite=variables_get(mySprite)\"\n"]]},{"start1":298,"length1":20,"diffs":[[1,"        _jugador = sprite\n"]]},{"start1":363,"length1":24,"diffs":[[1,"        if (!_jugador) return\n"]]},{"start1":394,"length1":241,"diffs":[[1,"        // 1. Obtener la imagen del tile donde están los pies\n        let col = Math.floor(_jugador.x / 16)\n        let row = Math.floor((_jugador.bottom + 1) / 16)\n        let imgTile = tiles.getTileAt(col, row)\n"]]},{"start1":608,"length1":279,"diffs":[[1,"        // 2. Si hay un tile (no es aire)\n        if (imgTile && imgTile.width > 0) {\n"]]},{"start1":695,"length1":128,"diffs":[[1,"            // 3. ENCONTRAR EL PÍXEL MÁS ALTO (Detección 1x1)\n            // Escaneamos la columna de píxeles del tile donde está el centro del sprite\n            let xRel = Math.floor(_jugador.x % 16)\n            if (xRel < 0) xRel += 16\n"]]},{"start1":935,"length1":403,"diffs":[[1,"            let yPixelSuelo = -1\n            // Buscamos desde arriba (0) hacia abajo (15) el primer píxel no transparente\n            for (let y = 0; y < 16; y++) {\n                if (imgTile.getPixel(xRel, y) != 0) {\n                    yPixelSuelo = y\n"]]},{"start1":1249,"length1":44,"diffs":[[1,""]]},{"start1":1250,"length1":125,"diffs":[[1,"            // 4. LEVITACIÓN AL PÍXEL EXACTO\n            if (yPixelSuelo != -1) {\n                let yGlobalSuelo = (row * 16) + yPixelSuelo\n\n                // Si el sprite está colisionando con ese píxel\n                if (_jugador.bottom >= yGlobalSuelo - 2) {\n                    _jugador.bottom = yGlobalSuelo\n                    // Anular gravedad para evitar vibraciones\n                    if (_jugador.vy > 0) _jugador.vy = 0\n                }\n            }\n"]]}]}]},{"timestamp":1771762046694,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":276,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]}]},{"timestamp":1771762111843,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":0,"length1":52,"diffs":[[1,"//% color=\"#268388\" icon=\"\\uf110\" block=\"RampasMaestras\"\n"]]},{"start1":111,"length1":129,"diffs":[[1,"     * Activa el anclaje de precisión 1x1.\n     * IMPORTANTE: No pongas muros rojos en la rampa ni en el suelo.\n"]]},{"start1":231,"length1":77,"diffs":[[1,"    //% block=\"activar anclaje en %sprite=variables_get(mySprite)\"\n"]]},{"start1":428,"length1":174,"diffs":[[1,"        // 1. Escaneamos 3 puntos bajo el sprite (izquierda, centro, derecha)\n        // para asegurar que siempre detecte la rampa aunque solo toque una punta.\n        let puntosX = [_s.x - 4, _s.x, _s.x + 4]\n        let encontrado = false\n"]]},{"start1":670,"length1":440,"diffs":[[1,"        for (let x of puntosX) {\n            // Buscamos desde la cintura del sprite hasta 8 píxeles abajo del suelo\n            for (let offset = -4; offset <= 8; offset++) {\n"]]},{"start1":1153,"length1":66,"diffs":[[1,"                    // 2. ¡ENCONTRADO!: Fijamos el sprite al píxel exacto\n                    _s.bottom = (row * 16) + (checkY % 16)\n"]]},{"start1":1287,"length1":627,"diffs":[[1,"                    // 3. MATAR FÍSICAS: Cancelamos velocidad de caída y gravedad\n                    if (_s.vy > 0) _s.vy = 0\n                    _s.ay = 0\n                    encontrado = true\n                    break\n"]]},{"start1":1540,"length1":39,"diffs":[[1,"            if (encontrado) break\n"]]},{"start1":1584,"length1":0,"diffs":[[1,"\n        // 4. Si no hay nada bajo los pies, devolvemos la gravedad normal\n        if (!encontrado) {\n            _s.ay = 350\n        }\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":633,"length1":323,"diffs":[[1,"    \"ejemplo_rampa1\": {\n        \"id\": \"ejemplo_rampa1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMTAwMDAwMDAwMDAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMjIyMjIyMjIyMjIyMjIyMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMA==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"sprites.castle.tilePath2\",\n            \"myTiles.tile1\"\n        ],\n        \"displayName\": \"ejemplo_rampa\"\n"]]},{"start1":1981,"length1":660,"diffs":[[1,""]]},{"start1":2069,"length1":1060,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":3217,"length1":126,"diffs":[[1,"            \"sprites.castle.tilePath2\"\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":280,"length1":306,"diffs":[[1,""]]},{"start1":389,"length1":0,"diffs":[[1,"            case \"ejemplo_rampa\":\n            case \"ejemplo_rampa1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020100000000000001010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . 2 . . . . . . \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n`, [myTiles.transparency16,sprites.castle.tilePath2,myTiles.tile1], TileScale.Sixteen);\n"]]},{"start1":1659,"length1":585,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102000000000002020202020202020202020202020202`, img`\n"]]},{"start1":2772,"length1":130,"diffs":[[1,"`, [myTiles.transparency16,myTiles.tile1,sprites.castle.tilePath2], TileScale.Sixteen);\n"]]},{"start1":3130,"length1":210,"diffs":[[1,""]]}]}]},{"timestamp":1771762666605,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":106,"length1":119,"diffs":[[1,"     * Activa la rampa de precisión desde las puntas sin quitar la gravedad.\n     * RECUERDA: No pongas muros rojos en la rampa.\n"]]},{"start1":243,"length1":76,"diffs":[[1,"    //% block=\"activar rampa instantánea en %sprite=variables_get(mySprite)\"\n"]]},{"start1":450,"length1":228,"diffs":[[1,"        // 1. SENSOR ANTICIPADO (2px por delante de las puntas)\n        let dir = _s.vx > 0 ? 1 : (_s.vx < 0 ? -1 : 0)\n        let puntaX = _s.x + (dir * (_s.width / 2 + 2))\n"]]},{"start1":625,"length1":0,"diffs":[[1,"        // Puntos a revisar: Punta delantera, centro y punta trasera\n        let puntosX = [puntaX, _s.left, _s.right, _s.x]\n        let sueloEncontrado = false\n\n"]]},{"start1":870,"length1":146,"diffs":[[1,"            // 2. ESCANEO VERTICAL (8px arriba a 4px abajo)\n            // Escanear hacia arriba permite \"ver\" la rampa antes de chocar\n            for (let offset = -8; offset <= 4; offset++) {\n"]]},{"start1":1298,"length1":220,"diffs":[[1,"                if (img && img.getPixel(checkX % 16, checkY % 16) != 0) {\n                    let yGlobalSuelo = (row * 16) + (checkY % 16)\n"]]},{"start1":1439,"length1":248,"diffs":[[1,"                    // 3. SUBIDA AUTOMÁTICA\n                    if (_s.bottom >= yGlobalSuelo - 8) {\n                        _s.bottom = yGlobalSuelo\n\n                        // 4. MANTENER GRAVEDAD ACTIVA\n                        // Solo frenamos la velocidad de caída (vy), \n                        // pero NO tocamos la aceleración (ay), así el sprite sigue pesando.\n                        if (_s.vy > 0) _s.vy = 0\n\n                        // Evitamos el hundimiento forzando la posición\n                        _s.y -= 0.1\n\n                        sueloEncontrado = true\n"]]},{"start1":2098,"length1":0,"diffs":[[1,"            if (sueloEncontrado) break\n"]]},{"start1":2147,"length1":414,"diffs":[[1,""]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":978,"length1":204,"diffs":[[1,"        \"data\": \"hwQQABAAAAAAAAAAAAAA/wAAAAAAAPD/AAAAAADw//8AAAAAAP///wAAAAD/////AAAA8P////8AAPD//////wAA////////AP/////////w/////////////////////////////////////////////////////////////////////////w==\",\n"]]},{"start1":1308,"length1":204,"diffs":[[1,"        \"data\": \"hwQQABAAAAD////////////////////////////////////////////////////////////////w/////////wD/////////AAD///////8AAPD//////wAAAPD/////AAAAAP////8AAAAAAP///wAAAAAA8P//AAAAAAAA8P8AAAAAAAAA/w==\",\n"]]},{"start1":1711,"length1":1060,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDMwMDAwMDAwMDAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":722,"length1":585,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102030000000002020202020202020202020202020202`, img`\n"]]},{"start1":1769,"length1":33,"diffs":[[1,". . . . . . . . . . 2 . . . . . \n"]]}]}]},{"timestamp":1771763323584,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":503,"length1":137,"diffs":[[1,"        // Usamos una variable de array clásica para evitar el error de la línea 22\n        let puntosX = [_s.left - 1, _s.right + 1, _s.x]\n"]]},{"start1":751,"length1":146,"diffs":[[1,"            // 2. ESCANEO VERTICAL (Buscamos suelo desde 10px arriba hasta 4px abajo)\n            for (let offset = -10; offset <= 4; offset++) {\n"]]},{"start1":1351,"length1":55,"diffs":[[1,""]]},{"start1":1464,"length1":72,"diffs":[[1,""]]},{"start1":1694,"length1":237,"diffs":[[1,"        // 3. APLICAR POSICIÓN SIN ANULAR GRAVEDAD\n        if (mejorY != -1 && _s.bottom >= mejorY - 10) {\n            // Solo anclamos si el sprite está cayendo o quieto (vy >= 0)\n"]]},{"start1":1905,"length1":70,"diffs":[[1,""]]},{"start1":1940,"length1":154,"diffs":[[1,""]]},{"start1":1967,"length1":83,"diffs":[[1,"                // Micro-empuje para que la gravedad nativa no lo hunda al estar quieto\n"]]}]}]},{"timestamp":1771763329102,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":97,"length1":43,"diffs":[[1,""]]},{"start1":106,"length1":153,"diffs":[[1,"     * Activa la física de rampa 1x1 bidireccional por puntas.\n     * REGLA DE ORO: No pongas muros rojos en la rampa.\n"]]},{"start1":375,"length1":471,"diffs":[[1,""]]},{"start1":414,"length1":36,"diffs":[[1,"        if (!_s) return\n"]]},{"start1":439,"length1":155,"diffs":[[1,"        // 1. SENSORES: Punta Izquierda, Punta Derecha y Centro\n        // Miramos 2px extra hacia afuera para detectar la rampa ANTES de chocar\n        let puntosX = [_s.left - 2, _s.right + 2, _s.x]\n        let mejorY = -1\n"]]},{"start1":748,"length1":230,"diffs":[[1,"            // 2. ESCANEO VERTICAL (Buscamos suelo desde 12px arriba hasta 4px abajo)\n            for (let offset = -12; offset <= 4; offset++) {\n"]]},{"start1":1171,"length1":164,"diffs":[[1,"                    let pixX = checkX % 16\n                    if (pixX < 0) pixX += 16\n                    let pixY = checkY % 16\n                    if (pixY < 0) pixY += 16\n"]]},{"start1":1348,"length1":682,"diffs":[[1,"                    // DETECCIÓN DE PÍXEL (Color != 0)\n                    if (img.getPixel(pixX, pixY) != 0) {\n                        let yGlobal = (row * 16) + pixY\n                        // Nos quedamos con el punto más alto detectado\n                        if (mejorY == -1 || yGlobal < mejorY) {\n                            mejorY = yGlobal\n"]]},{"start1":1723,"length1":0,"diffs":[[1,"                        break\n"]]},{"start1":1807,"length1":38,"diffs":[[1,""]]},{"start1":1818,"length1":127,"diffs":[[1,"        // 3. COMPENSACIÓN DINÁMICA DE GRAVEDAD\n        // Si hay suelo detectado cerca de los pies\n        if (mejorY != -1 && _s.bottom >= mejorY - 12) {\n\n            // Solo bloqueamos la caída si el sprite no está saltando (vy >= 0)\n            if (_s.vy >= 0) {\n                // Forzamos la posición para que \"encaje\" en la rampa\n                _s.bottom = mejorY\n\n                // Neutralizamos la velocidad de caída acumulada por la gravedad\n                // para que no atraviese el suelo en el siguiente frame\n                _s.vy = 0\n\n                // Micro-ajuste para combatir el empuje de la gravedad nativa (ay)\n                _s.y -= 0.1\n            }\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1711,"length1":1060,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMDAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":722,"length1":585,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040205000000000102030000000002020202020202020202020202020202`, img`\n"]]},{"start1":1736,"length1":33,"diffs":[[1,". . . . . . . . . . . . . . . . \n"]]}]}]},{"timestamp":1771763815556,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":97,"length1":0,"diffs":[[1,"    let gBase = 0\n    let saltando = false\n"]]},{"start1":149,"length1":128,"diffs":[[1,"     * Activa la física de rampa 1x1 con límite de escalada para no saltar muros.\n     * REGLA DE ORO: No pongas muros rojos en la rampa ni en el suelo.\n"]]},{"start1":452,"length1":0,"diffs":[[1,"        gBase = _s.ay // Guardamos la gravedad inicial\n\n        // GESTIÓN DE SALTO: Pausa el sistema 300ms para permitir el impulso\n        controller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n            if (Math.abs(_s.vy) < 5) {\n                _s.vy = -150\n                saltando = true\n                control.runInParallel(function () {\n                    pause(300)\n                    saltando = false\n                })\n            }\n        })\n"]]},{"start1":962,"length1":24,"diffs":[[1,"        if (!_s || saltando) return\n"]]},{"start1":999,"length1":221,"diffs":[[1,"        // 1. SENSORES DE PRECISIÓN (Solo las puntas reales del sprite)\n"]]},{"start1":1119,"length1":29,"diffs":[[1,"        let sueloDetectado = false\n"]]},{"start1":1238,"length1":284,"diffs":[[1,"            // 2. ESCANEO VERTICAL LIMITADO (Solo 4px arriba para no teletransportarse)\n            // Al limitar el offset a -4, si choca con un muro de 16px, no subirá.\n            for (let offset = -4; offset <= 6; offset++) {\n"]]},{"start1":1963,"length1":178,"diffs":[[1,"                        let yGlobalSuelo = (row * 16) + py\n\n                        // 3. ANCLAJE Y SUBIDA CONTROLADA\n                        // Solo subimos si el píxel está a menos de 4px de los pies\n                        if (_s.bottom >= yGlobalSuelo - 4) {\n                            _s.bottom = yGlobalSuelo\n                            _s.ay = 0 // Anulamos gravedad para no hundirse\n                            if (_s.vy > 0) _s.vy = 0\n\n                            // Micro-empuje anti-vibración\n                            _s.y -= 0.1\n                            sueloDetectado = true\n                            break\n"]]},{"start1":2618,"length1":30,"diffs":[[1,""]]},{"start1":2672,"length1":0,"diffs":[[1,"            if (sueloDetectado) break\n"]]},{"start1":2721,"length1":464,"diffs":[[1,"        // 4. RESTAURAR FÍSICA si no hay píxel sólido bajo las puntas\n        if (!sueloDetectado) {\n            _s.ay = gBase\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1711,"length1":1060,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMDAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDAwMDIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":722,"length1":585,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000040205000000000102030000000002020202020202020202020202020202`, img`\n"]]},{"start1":1670,"length1":132,"diffs":[[1,". . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . 2 . . . . . . . . \n. . . 2 . . . . . . 2 . . . . . \n"]]}]}]},{"timestamp":1771764405134,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":975,"length1":29,"diffs":[[1,"rampas.activar(mySprite)\n"]]}]},{"type":"edited","filename":"physics.ts","patch":[{"start1":0,"length1":70,"diffs":[[1,"//% color=\"#268388\" icon=\"\\uf110\" block=\"RampasPro\"\nnamespace rampas {\n"]]},{"start1":97,"length1":24,"diffs":[[1,""]]},{"start1":106,"length1":139,"diffs":[[1,"     * Activa la física de rampa 1x1 con límite de escalada de 1 píxel.\n     * REGLA DE ORO: No pongas muros rojos en la rampa.\n"]]},{"start1":242,"length1":112,"diffs":[[1,"    //% block=\"activar rampa definitiva en %sprite=variables_get(mySprite)\"\n    export function activar(sprite: Sprite) {\n"]]},{"start1":384,"length1":588,"diffs":[[1,""]]},{"start1":423,"length1":35,"diffs":[[1,"        if (!_s) return\n"]]},{"start1":448,"length1":74,"diffs":[[1,"        // 1. FILTRO DE SALTO: Si el personaje está subiendo (vy < 0),\n        // apagamos el sistema para que el salto sea 100% libre.\n"]]},{"start1":615,"length1":138,"diffs":[[1,"        // 2. SENSORES DE PUNTA (Izquierda y Derecha)\n        let puntosX = [_s.left, _s.right, _s.x]\n        let encontradoY = -1\n"]]},{"start1":747,"length1":82,"diffs":[[1,"        for (let i = 0; i < puntosX.length; i++) {\n            let x = puntosX[i]\n"]]},{"start1":830,"length1":204,"diffs":[[1,"            // 3. ANTI-TELETRANSPORTE (Escaneo de 1 solo píxel arriba)\n            // Al mirar solo -1px, es IMPOSIBLE que detecte el techo de un muro.\n            // Solo detectará el siguiente píxel de una pendiente suave.\n            for (let offset = -1; offset <= 4; offset++) {\n"]]},{"start1":1556,"length1":64,"diffs":[[1,""]]},{"start1":1663,"length1":106,"diffs":[[1,"                        if (encontradoY == -1 || yGlobal < encontradoY) {\n                            encontradoY = yGlobal\n"]]},{"start1":1908,"length1":132,"diffs":[[1,"        // 4. ANCLAJE DE PRECISIÓN MILIMÉTRICA\n        if (encontradoY != -1) {\n            // Solo aplicamos si el suelo está a máximo 1px de altura (rampa real)\n            if (_s.bottom >= encontradoY - 1) {\n                _s.bottom = encontradoY\n"]]},{"start1":2160,"length1":91,"diffs":[[1,"                // Si está cayendo, frenamos la caída\n                if (_s.vy > 0) _s.vy = 0\n"]]},{"start1":2256,"length1":85,"diffs":[[1,"                // Compensación de gravedad para que no vibre ni se hunda\n                _s.y -= 0.1\n            }\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1623,"length1":330,"diffs":[[1,""]]},{"start1":1711,"length1":1060,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMjAwMDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDAwMDAwMDAyMDAwMDIwMDAwMDAwMDAwMjIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":2957,"length1":57,"diffs":[[1,"            \"myTiles.tile4\"\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":586,"length1":102,"diffs":[[1,""]]},{"start1":722,"length1":585,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000200000000000000000000000000000202000000000000000000000000000002020000000000000200000000000000020200040205000000000102030000000202020202020202020202020202020202`, img`\n"]]},{"start1":1835,"length1":144,"diffs":[[1,"`, [myTiles.transparency16,myTiles.tile1,sprites.castle.tilePath2,myTiles.tile2,myTiles.tile3,myTiles.tile4], TileScale.Sixteen);\n"]]},{"start1":2445,"length1":70,"diffs":[[1,""]]}]}]},{"timestamp":1771764993795,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":120,"length1":23,"diffs":[[1,""]]},{"start1":129,"length1":115,"diffs":[[1,"     * Adds 1x1 pixel physics to a sprite for ramps and slopes.\n     * RULE: Do not set red walls on the ramp tiles in the tilemap editor.\n"]]},{"start1":409,"length1":0,"diffs":[[1,"        // JUMP LOGIC: When A is pressed, disable the ramp magnet for 300ms\n"]]},{"start1":559,"length1":0,"diffs":[[1,"            // Only jump if we are on the ground/ramp (vertical velocity near 0)\n"]]},{"start1":679,"length1":29,"diffs":[[1,"                _s.vy = -150 // Jump force\n"]]},{"start1":753,"length1":0,"diffs":[[1,"                // Run a parallel pause to re-enable ramp physics after takeoff\n"]]},{"start1":1071,"length1":0,"diffs":[[1,"        // 1. VELOCITY FILTER: If already moving up, don't snap to ground\n"]]},{"start1":1176,"length1":129,"diffs":[[1,"        // 2. SYMMETRIC SCANNING (Left tip, Right tip, and Center)\n        let pointsX = [_s.left, _s.right, _s.x]\n"]]},{"start1":1315,"length1":146,"diffs":[[1,"        for (let i = 0; i < pointsX.length; i++) {\n            let x = pointsX[i]\n"]]},{"start1":1398,"length1":183,"diffs":[[1,"            // 3. ANTI-TELEPORT: Scan only 3px above feet\n            // This range is blind to 16px walls, preventing \"teleporting\" to the top.\n            for (let offset = -3; offset <= 4; offset++) {\n                let checkX = Math.floor(x)\n                let checkY = Math.floor(_s.bottom + offset)\n"]]},{"start1":1706,"length1":414,"diffs":[[1,"                let col = checkX >> 4\n                let row = checkY >> 4\n                let img = tiles.getTileAt(col, row)\n\n                if (img && img.width > 0) {\n                    let px = checkX % 16\n                    if (px < 0) px += 16\n                    let py = checkY % 16\n                    if (py < 0) py += 16\n\n                    // If pixel is not transparent (color != 0)\n                    if (img.getPixel(px, py) != 0) {\n                        let yGlobal = (row * 16) + py\n                        if (bestY == -1 || yGlobal < bestY) {\n                            bestY = yGlobal\n                        }\n                        break\n                    }\n                }\n"]]},{"start1":2442,"length1":41,"diffs":[[1,"        // 4. PRECISION ANCHORING (Anti-sinking)\n"]]},{"start1":2574,"length1":0,"diffs":[[1,"\n            // Neutralize gravity's downward velocity\n"]]},{"start1":2666,"length1":0,"diffs":[[1,"\n            // Micro-adjustment to stay on top of the pixel\n"]]},{"start1":2769,"length1":661,"diffs":[[1,""]]}]}]},{"timestamp":1771765090637,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1953,"length1":330,"diffs":[[1,""]]},{"start1":2041,"length1":1060,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA2MDAwMDAwMDYwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDYwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDYwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMjAwMDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDAwMDAwMDAyMDAwMDIwMDAwMDAwMDAwMjIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":3316,"length1":57,"diffs":[[1,"            \"myTiles.tile5\"\n"]]}]}]},{"timestamp":1771765889542,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":688,"length1":102,"diffs":[[1,""]]},{"start1":824,"length1":585,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000060000000000000000000000000000000000000000000000000000000000060000000000000000000102000000000000000000000000000000000000000000060000000200000000000000000000000000000202000000000000000000000000000002020000000000000200000000000000020200040205000000000102030000000202020202020202020202020202020202`, img`\n"]]},{"start1":1937,"length1":158,"diffs":[[1,"`, [myTiles.transparency16,myTiles.tile1,sprites.castle.tilePath2,myTiles.tile2,myTiles.tile3,myTiles.tile4,myTiles.tile5], TileScale.Sixteen);\n"]]},{"start1":2631,"length1":70,"diffs":[[1,""]]}]}]},{"timestamp":1771765896050,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"physics.ts","patch":[{"start1":120,"length1":0,"diffs":[[1,"    let slopeAngle = 0\n"]]},{"start1":152,"length1":139,"diffs":[[1,"     * Adds 1x1 pixel physics to a sprite with slope sliding.\n     * RULE: Do not set red walls on the ramp tiles.\n"]]},{"start1":408,"length1":76,"diffs":[[1,""]]},{"start1":482,"length1":81,"diffs":[[1,""]]},{"start1":521,"length1":43,"diffs":[[1,"                _s.vy = -150\n"]]},{"start1":581,"length1":80,"diffs":[[1,""]]},{"start1":819,"length1":74,"diffs":[[1,""]]},{"start1":850,"length1":115,"diffs":[[1,"        // 1. ESCANEO DE PUNTAS (Izquierda y Derecha)\n        let yL = getSueloEn(_s.left)\n        let yR = getSueloEn(_s.right)\n"]]},{"start1":1003,"length1":82,"diffs":[[1,"        // Calculamos el píxel más alto detectado\n        if (yL != -1 && (yR == -1 || yL < yR)) bestY = yL\n        else if (yR != -1) bestY = yR\n"]]},{"start1":1150,"length1":307,"diffs":[[1,"        // 2. LÓGICA DE DESLIZAMIENTO (Fricción)\n        if (yL != -1 && yR != -1) {\n            // Calculamos la diferencia de altura entre las puntas\n            let diff = yL - yR\n"]]},{"start1":1334,"length1":711,"diffs":[[1,"            // Si la diferencia es grande, el personaje \"resbala\" hacia el lado más bajo\n            if (Math.abs(diff) > 2 && _s.vx == 0) {\n                if (diff < 0) _s.vx -= 5  // Resbala a la izquierda\n                else _s.vx += 5         // Resbala a la derecha\n            } else if (_s.vx != 0) {\n                // Aplicamos fricción gradual para frenar el deslizamiento\n                _s.vx *= 0.9\n"]]},{"start1":1773,"length1":49,"diffs":[[1,"        // 3. ANCLAJE Y ANTI-HUNDIMIENTO\n"]]},{"start1":1897,"length1":55,"diffs":[[1,""]]},{"start1":1934,"length1":61,"diffs":[[1,""]]},{"start1":1976,"length1":0,"diffs":[[1,"\n    // Función auxiliar para escanear el suelo en un punto X\n    function getSueloEn(x: number): number {\n        for (let offset = -4; offset <= 4; offset++) {\n            let cx = Math.floor(x)\n            let cy = Math.floor(_s.bottom + offset)\n            let img = tiles.getTileAt(cx >> 4, cy >> 4)\n\n            if (img && img.width > 0) {\n                let px = cx % 16\n                if (px < 0) px += 16\n                let py = cy % 16\n                if (py < 0) py += 16\n\n                if (img.getPixel(px, py) != 0) {\n                    return (Math.floor(cy / 16) * 16) + py\n                }\n            }\n        }\n        return -1\n    }\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":304,"length1":219,"diffs":[[1,"    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAA8AAAAAAAAAD/AAAAAAAA8P8AAAAAAAD//wAAAAAA8P//AAAAAAD///8AAAAA8P///wAAAAD/////AAAA8P////8AAAD//////wAA8P//////AAD///////8A8P///////wD/////////8P///////////////////w==\",\n"]]},{"start1":591,"length1":36,"diffs":[[1,"        \"displayName\": \"miMosaico\"\n"]]},{"start1":633,"length1":219,"diffs":[[1,"    \"tile2\": {\n        \"data\": \"hwQQABAAAAD///////////D/////////AP////////8A8P///////wAA////////AADw//////8AAAD//////wAAAPD/////AAAAAP////8AAAAA8P///wAAAAAA////AAAAAADw//8AAAAAAAD//wAAAAAAAPD/AAAAAAAAAP8AAAAAAAAA8A==\",\n"]]},{"start1":920,"length1":36,"diffs":[[1,"        \"displayName\": \"miMosaico0\"\n"]]},{"start1":963,"length1":219,"diffs":[[1,"    \"tile3\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAADw/wAAAAAA8P//AAAAAAD///8AAAAA/////wAAAPD/////AADw//////8AAP///////wD/////////8P///////////////////w==\",\n"]]},{"start1":1250,"length1":36,"diffs":[[1,"        \"displayName\": \"miMosaico1\"\n"]]},{"start1":1293,"length1":0,"diffs":[[1,"    \"tile4\": {\n        \"data\": \"hwQQABAAAAD///////////D/////////AP////////8AAP///////wAA8P//////AAAA8P////8AAAAA/////wAAAAAA////AAAAAADw//8AAAAAAADw/wAAAAAAAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico2\"\n    },\n    \"tile5\": {\n        \"data\": \"hwQQABAAAAAAAP////8AAAD///////8A8P///////w/w////////D//////////////////////////////////////////////////////////////////////////////////////w////////D/D///////8PAP///////wAAAP////8AAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico3\"\n    },\n    \"tile6\": {\n        \"data\": \"hwQQABAAAAD//////////wAA////////AAAAAP////8AAAAAAPD//wAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico4\"\n    },\n"]]},{"start1":2371,"length1":1636,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA2MDAwMDAwMDYwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDYwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDYwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMjA3MDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDAwMDAwMDAyMDAwMDIwMDAwMDAwMDAwMjIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":3490,"length1":0,"diffs":[[1,"            \"myTiles.tile1\",\n"]]},{"start1":3559,"length1":86,"diffs":[[1,"            \"myTiles.tile2\",\n            \"myTiles.tile3\",\n            \"myTiles.tile4\",\n            \"myTiles.tile5\",\n            \"myTiles.tile6\"\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":232,"length1":48,"diffs":[[1,"    export const tile1 = image.ofBuffer(hex``);\n"]]},{"start1":334,"length1":48,"diffs":[[1,"    export const tile2 = image.ofBuffer(hex``);\n"]]},{"start1":436,"length1":48,"diffs":[[1,"    export const tile3 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile4 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile5 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile6 = image.ofBuffer(hex``);\n"]]},{"start1":926,"length1":1405,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000060000000000000000000000000000000000000000000000000000000000060000000000000000000102000000000000000000000000000000000000000000060000000200000000000000000000000000000202000000000000000000000000000002020000000000000200000000000000020207040205000000000102030000000202020202020202020202020202020202`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n. . . . . . . . . . . . . . . . \n2 . . . . . . . . . . . . . . . \n2 . . . . . . . . . . . . . . . \n2 . . . . . . 2 . . . . . . . . \n2 . . 2 . . . . . . 2 . . . . . \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`, [myTiles.transparency16,myTiles.tile1,sprites.castle.tilePath2,myTiles.tile2,myTiles.tile3,myTiles.tile4,myTiles.tile5,myTiles.tile6], TileScale.Sixteen);\n"]]},{"start1":2398,"length1":210,"diffs":[[1,"            case \"miMosaico\":\n            case \"tile1\":return tile1;\n            case \"miMosaico0\":\n            case \"tile2\":return tile2;\n            case \"miMosaico1\":\n            case \"tile3\":return tile3;\n            case \"miMosaico2\":\n            case \"tile4\":return tile4;\n            case \"miMosaico3\":\n            case \"tile5\":return tile5;\n            case \"miMosaico4\":\n            case \"tile6\":return tile6;\n"]]}]}]},{"timestamp":1771766272268,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":1664,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"Tf~z_1_;_}*1%qa#jDSJ\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"l56R9So_}K9gu5v{qc]v\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"?kCK}zns~~pDoMnErR_j\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"$HoLRvY@trz7xW+/iC.J\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n"]]},{"start1":1306,"length1":1764,"diffs":[[1,"`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"rampas_activar\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"keyonevent\" x=\"846\" y=\"-31\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-150</field></shadow></value></block></statement></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":127,"length1":28,"diffs":[[1,"        mySprite.vy += -150\n"]]},{"start1":975,"length1":28,"diffs":[[1,""]]},{"start1":1004,"length1":0,"diffs":[[1,"scene.setBackgroundColor(9)\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":276,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1294,"length1":1319,"diffs":[[1,""]]},{"start1":1382,"length1":1636,"diffs":[[1,"        \"data\": \"MTAxOTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwNDAyMDMwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQwMjAzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":3175,"length1":144,"diffs":[[1,"            \"myTiles.tile9\"\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":484,"length1":408,"diffs":[[1,""]]},{"start1":620,"length1":873,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1900100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000402030000000000000000000000000000000000000000040203000000000000000000000000000000000000000000020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101`, img`\n"]]},{"start1":1909,"length1":172,"diffs":[[1,"`, [myTiles.transparency16,sprites.castle.tilePath2,myTiles.tile7,myTiles.tile8,myTiles.tile9], TileScale.Sixteen);\n"]]},{"start1":2436,"length1":279,"diffs":[[1,""]]}]}]},{"timestamp":1771766736566,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":1662,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"h2fWldLSRCoYR7b/28:I\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"1@TpKk5NHrCNF:Ipk?}%\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"`,Lwk,zf=cOgh~G*y+7B\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"xkk+.wEPltA3+(OZw=9u\">Enemy</variable></variables><block type=\"keyonevent\" x=\"834\" y=\"-59\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-200</field></shadow></value></block></statement></block></statement></block><block type=\"pxt-on-start\" x=\"14\" y=\"37\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":2613,"length1":991,"diffs":[[1,""]]},{"start1":2701,"length1":1636,"diffs":[[1,"        \"data\": \"MTAxOTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDUwNjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwNDAyMDMwMDAwMDAwMDAwMDAwNzA4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQwMjAzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":4610,"length1":116,"diffs":[[1,"            \"myTiles.tile4\"\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":892,"length1":307,"diffs":[[1,""]]},{"start1":1028,"length1":873,"diffs":[[1,"            case \"nivel1\":return tiles.createTilemap(hex`1900100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050600000000000000000000000000000402030000000000000708000000000000000000000000040203000000000000000000000000000000000000000000020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101`, img`\n"]]},{"start1":2317,"length1":215,"diffs":[[1,"`, [myTiles.transparency16,sprites.castle.tilePath2,myTiles.tile7,myTiles.tile8,myTiles.tile9,myTiles.tile1,myTiles.tile2,myTiles.tile3,myTiles.tile4], TileScale.Sixteen);\n"]]},{"start1":3179,"length1":212,"diffs":[[1,""]]}]}]},{"timestamp":1771767579040,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":276,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]}]},{"timestamp":1771767595709,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":444,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"h2fWldLSRCoYR7b/28:I\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"1@TpKk5NHrCNF:Ipk?}%\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"`,Lwk,zf=cOgh~G*y+7B\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"xkk+.wEPltA3+(OZw=9u\">Enemy</variable></variables><block type=\"keyonevent\" x=\"820\" y=\"-96\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-200</field></shadow></value></block></statement></block></statement></block><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value><next><block type=\"physics_addPhysics\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>"]]}]}]},{"timestamp":1771768984137,"editorVersion":"4.0.7","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":276,"length1":44,"diffs":[[1,""]]}]},{"type":"added","filename":"test.ts","value":"// aquí van las pruebas; esto no se compilará cuando este paquete se utilice como extensión.\n"}]}],"snapshots":[{"timestamp":1771759749460,"editorVersion":"4.0.7","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <variables></variables>\n  <block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block>\n</xml>","main.ts":" ","README.md":" ","assets.json":"","pxt.json":"{\n    \"name\": \"Slope\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}},{"timestamp":1771761574659,"editorVersion":"4.0.7","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"Tf~z_1_;_}*1%qa#jDSJ\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"l56R9So_}K9gu5v{qc]v\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"?kCK}zns~~pDoMnErR_j\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"$HoLRvY@trz7xW+/iC.J\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"rampas_activar\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"keyonevent\" x=\"846\" y=\"-31\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-150</field></shadow></value></block></statement></block></statement></block></xml>","main.ts":"","README.md":" ","assets.json":"","physics.ts":"//% color=\"#268388\" icon=\"\\uf110\" block=\"RampasPro\"\nnamespace rampas {\n    let _sprite: Sprite = null\n\n    /**\n     * Activa la detección por puntas (esquinas inferiores)\n     */\n    //% block=\"activar rampa automática en %sprite=variables_get(mySprite)\"\n    export function activar(sprite: Sprite) {\n        _sprite = sprite\n    }\n\n    game.onUpdate(function () {\n        if (!_sprite) return\n\n        // 1. Determinar qué punta va delante según la velocidad\n        let direccion = _sprite.vx >= 0 ? 1 : -1\n        // Punta delantera (ancho / 2) y punta trasera\n        let puntaX = _sprite.x + (direccion * (_sprite.width / 2))\n        let pieY = _sprite.bottom\n\n        // 2. Localizar el tile bajo esa punta específica\n        let col = Math.floor(puntaX / 16)\n        let row = Math.floor((pieY + 2) / 16) // Miramos 2 píxeles abajo\n        let imgTile = tiles.getTileAt(col, row)\n\n        if (imgTile && imgTile.width > 0) {\n            // 3. DETECCIÓN 1x1 EN LA PUNTA\n            let xRel = Math.floor(puntaX % 16)\n            if (xRel < 0) xRel += 16\n\n            let yPixelSuelo = -1\n            // Buscamos el primer píxel sólido del dibujo del tile (0-15)\n            for (let y = 0; y < 16; y++) {\n                if (imgTile.getPixel(xRel, y) != 0) {\n                    yPixelSuelo = y\n                    break\n                }\n            }\n\n            // 4. SUBIDA AUTOMÁTICA (LEVITACIÓN)\n            if (yPixelSuelo != -1) {\n                let yGlobalSuelo = (row * 16) + yPixelSuelo\n\n                // Si la punta del sprite está tocando o entrando en el píxel\n                if (_sprite.bottom >= yGlobalSuelo - 4) {\n                    // Forzamos la posición vertical para que encaje perfectamente\n                    _sprite.bottom = yGlobalSuelo\n\n                    // Cancelamos gravedad para que no \"tiemble\" al subir\n                    if (_sprite.vy > 0) _sprite.vy = 0\n                }\n            }\n        }\n    })\n}\n","tilemap.g.jres":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAA8AAAAAAAAAD/AAAAAAAA8P8AAAAAAAD//wAAAAAA8P//AAAAAAD///8AAAAA8P///wAAAAD/////AAAA8P////8AAAD//////wAA8P//////AAD///////8A8P///////wD/////////8P///////////////////w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico\"\n    },\n    \"ejemplo_rampa1\": {\n        \"id\": \"ejemplo_rampa1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMTAwMDAwMDAwMDAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMjIyMjIyMjIyMjIyMjIyMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMA==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"sprites.castle.tilePath2\",\n            \"myTiles.tile1\"\n        ],\n        \"displayName\": \"ejemplo_rampa\"\n    },\n    \"nivel1\": {\n        \"id\": \"nivel1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"myTiles.tile1\",\n            \"sprites.castle.tilePath2\"\n        ],\n        \"displayName\": \"nivel1\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}","tilemap.g.ts":"","pxt.json":"{\n    \"name\": \"Slope\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\",\n        \"physics.ts\",\n        \"tilemap.g.jres\",\n        \"tilemap.g.ts\"\n    ],\n    \"preferredEditor\": \"blocksprj\"\n}\n"}},{"timestamp":1771763418354,"editorVersion":"4.0.7","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"Tf~z_1_;_}*1%qa#jDSJ\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"l56R9So_}K9gu5v{qc]v\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"?kCK}zns~~pDoMnErR_j\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"$HoLRvY@trz7xW+/iC.J\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"rampas_activar\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"keyonevent\" x=\"846\" y=\"-31\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-150</field></shadow></value></block></statement></block></statement></block></xml>","main.ts":"controller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    if (mySprite.isHittingTile(CollisionDirection.Bottom)) {\n        mySprite.vy += -150\n    }\n})\nlet mySprite: Sprite = null\nmySprite = sprites.create(img`\n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    `, SpriteKind.Player)\nscene.cameraFollowSprite(mySprite)\ntiles.setCurrentTilemap(tilemap`nivel1`)\nmySprite.ay = 350\ncontroller.moveSprite(mySprite, 100, 0)\nrampas.activar(mySprite)\nscene.setBackgroundColor(9)\n","README.md":" ","assets.json":"","physics.ts":"//% color=\"#268388\" icon=\"\\uf110\" block=\"RampasPro\"\nnamespace rampas {\n    let _s: Sprite = null\n\n    /**\n     * Activa la física de rampa 1x1 sin anular la gravedad (ay).\n     * REGLA DE ORO: No pongas muros rojos en la rampa.\n     */\n    //% block=\"activar rampa definitiva en %sprite=variables_get(mySprite)\"\n    export function activar(sprite: Sprite) {\n        _s = sprite\n    }\n\n    game.onUpdate(function () {\n        if (!_s) return\n\n        // 1. ESCANEO POR PUNTAS PROYECTADAS (Detección instantánea)\n        // Miramos 3px por fuera de los bordes izquierdo y derecho\n        let puntosX = [_s.left - 3, _s.right + 3, _s.x]\n        let sueloY = -1\n\n        for (let i = 0; i < puntosX.length; i++) {\n            let x = puntosX[i]\n\n            // 2. ESCANEO VERTICAL PROFUNDO (-12px a +4px)\n            // Buscamos suelo arriba para subir al instante antes de chocar\n            for (let offset = -12; offset <= 4; offset++) {\n                let checkX = Math.floor(x)\n                let checkY = Math.floor(_s.bottom + offset)\n\n                let col = checkX >> 4\n                let row = checkY >> 4\n                let img = tiles.getTileAt(col, row)\n\n                if (img && img.width > 0) {\n                    let px = checkX % 16\n                    if (px < 0) px += 16\n                    let py = checkY % 16\n                    if (py < 0) py += 16\n\n                    // DETECCIÓN DE PÍXEL (Color != 0)\n                    if (img.getPixel(px, py) != 0) {\n                        let yGlobal = (row * 16) + py\n                        if (sueloY == -1 || yGlobal < sueloY) {\n                            sueloY = yGlobal\n                        }\n                        break\n                    }\n                }\n            }\n        }\n\n        // 3. CORRECCIÓN DE POSICIÓN (Sin tocar ay)\n        if (sueloY != -1 && _s.bottom >= sueloY - 12) {\n\n            // Solo actuamos si el sprite está cayendo o quieto (vy >= 0)\n            // Esto permite que si saltas (vy < 0), el sprite suba libremente\n            if (_s.vy >= 0) {\n                // Forzamos el sprite a estar exactamente sobre el píxel\n                _s.bottom = sueloY\n\n                // IMPORTANTE: Ponemos vy a 0 para que no acumule fuerza de caída\n                // mientras toca el suelo, pero NO tocamos la gravedad (ay)\n                _s.vy = 0\n\n                // Micro-empuje para combatir el hundimiento visual de la gravedad\n                _s.y -= 0.1\n            }\n        }\n    })\n}\n","tilemap.g.jres":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAA8AAAAAAAAAD/AAAAAAAA8P8AAAAAAAD//wAAAAAA8P//AAAAAAD///8AAAAA8P///wAAAAD/////AAAA8P////8AAAD//////wAA8P//////AAD///////8A8P///////wD/////////8P///////////////////w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico\"\n    },\n    \"tile2\": {\n        \"data\": \"hwQQABAAAAD///////////D/////////AP////////8A8P///////wAA////////AADw//////8AAAD//////wAAAPD/////AAAAAP////8AAAAA8P///wAAAAAA////AAAAAADw//8AAAAAAAD//wAAAAAAAPD/AAAAAAAAAP8AAAAAAAAA8A==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico0\"\n    },\n    \"tile3\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAADw/wAAAAAA8P//AAAAAAD///8AAAAA/////wAAAPD/////AADw//////8AAP///////wD/////////8P///////////////////w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico1\"\n    },\n    \"tile4\": {\n        \"data\": \"hwQQABAAAAD///////////D/////////AP////////8AAP///////wAA8P//////AAAA8P////8AAAAA/////wAAAAAA////AAAAAADw//8AAAAAAADw/wAAAAAAAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico2\"\n    },\n    \"nivel1\": {\n        \"id\": \"nivel1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMDAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"myTiles.tile1\",\n            \"sprites.castle.tilePath2\",\n            \"myTiles.tile2\",\n            \"myTiles.tile3\",\n            \"myTiles.tile4\"\n        ],\n        \"displayName\": \"nivel1\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}","tilemap.g.ts":"","pxt.json":"{\n    \"name\": \"Slope\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\",\n        \"physics.ts\",\n        \"tilemap.g.jres\",\n        \"tilemap.g.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1771765889542,"editorVersion":"4.0.7","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"Tf~z_1_;_}*1%qa#jDSJ\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"l56R9So_}K9gu5v{qc]v\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"?kCK}zns~~pDoMnErR_j\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"$HoLRvY@trz7xW+/iC.J\">Enemy</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"rampas_activar\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"keyonevent\" x=\"846\" y=\"-31\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A#B*~{IcT.=I;wbY}UU#\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-150</field></shadow></value></block></statement></block></statement></block></xml>","main.ts":"controller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    if (mySprite.isHittingTile(CollisionDirection.Bottom)) {\n        mySprite.vy += -150\n    }\n})\nlet mySprite: Sprite = null\nmySprite = sprites.create(img`\n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    `, SpriteKind.Player)\nscene.cameraFollowSprite(mySprite)\ntiles.setCurrentTilemap(tilemap`nivel1`)\nmySprite.ay = 350\ncontroller.moveSprite(mySprite, 100, 0)\nphysics.addPhysics(mySprite)\nscene.setBackgroundColor(9)\n","README.md":" ","assets.json":"","physics.ts":"//% color=\"#268388\" icon=\"\\uf110\" block=\"Physics\"\nnamespace physics {\n    let _s: Sprite = null\n    let jumping = false\n    let slopeAngle = 0\n\n    /**\n     * Adds 1x1 pixel physics to a sprite with slope sliding.\n     * RULE: Do not set red walls on the ramp tiles.\n     */\n    //% block=\"add physics to %sprite=variables_get(mySprite)\"\n    export function addPhysics(sprite: Sprite) {\n        _s = sprite\n\n        controller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n            if (Math.abs(_s.vy) < 5) {\n                _s.vy = -150\n                jumping = true\n                control.runInParallel(function () {\n                    pause(300)\n                    jumping = false\n                })\n            }\n        })\n    }\n\n    game.onUpdate(function () {\n        if (!_s || jumping) return\n\n        if (_s.vy < 0) return\n\n        // 1. ESCANEO DE PUNTAS (Izquierda y Derecha)\n        let yL = getSueloEn(_s.left)\n        let yR = getSueloEn(_s.right)\n        let bestY = -1\n\n        // Calculamos el píxel más alto detectado\n        if (yL != -1 && (yR == -1 || yL < yR)) bestY = yL\n        else if (yR != -1) bestY = yR\n\n        // 2. LÓGICA DE DESLIZAMIENTO (Fricción)\n        if (yL != -1 && yR != -1) {\n            // Calculamos la diferencia de altura entre las puntas\n            let diff = yL - yR\n\n            // Si la diferencia es grande, el personaje \"resbala\" hacia el lado más bajo\n            if (Math.abs(diff) > 2 && _s.vx == 0) {\n                if (diff < 0) _s.vx -= 5  // Resbala a la izquierda\n                else _s.vx += 5         // Resbala a la derecha\n            } else if (_s.vx != 0) {\n                // Aplicamos fricción gradual para frenar el deslizamiento\n                _s.vx *= 0.9\n            }\n        }\n\n        // 3. ANCLAJE Y ANTI-HUNDIMIENTO\n        if (bestY != -1 && _s.bottom >= bestY - 4) {\n            _s.bottom = bestY\n            if (_s.vy > 0) _s.vy = 0\n            _s.y -= 0.15\n        }\n    })\n\n    // Función auxiliar para escanear el suelo en un punto X\n    function getSueloEn(x: number): number {\n        for (let offset = -4; offset <= 4; offset++) {\n            let cx = Math.floor(x)\n            let cy = Math.floor(_s.bottom + offset)\n            let img = tiles.getTileAt(cx >> 4, cy >> 4)\n\n            if (img && img.width > 0) {\n                let px = cx % 16\n                if (px < 0) px += 16\n                let py = cy % 16\n                if (py < 0) py += 16\n\n                if (img.getPixel(px, py) != 0) {\n                    return (Math.floor(cy / 16) * 16) + py\n                }\n            }\n        }\n        return -1\n    }\n}\n","tilemap.g.jres":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAA8AAAAAAAAAD/AAAAAAAA8P8AAAAAAAD//wAAAAAA8P//AAAAAAD///8AAAAA8P///wAAAAD/////AAAA8P////8AAAD//////wAA8P//////AAD///////8A8P///////wD/////////8P///////////////////w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico\"\n    },\n    \"tile2\": {\n        \"data\": \"hwQQABAAAAD///////////D/////////AP////////8A8P///////wAA////////AADw//////8AAAD//////wAAAPD/////AAAAAP////8AAAAA8P///wAAAAAA////AAAAAADw//8AAAAAAAD//wAAAAAAAPD/AAAAAAAAAP8AAAAAAAAA8A==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico0\"\n    },\n    \"tile3\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAADw/wAAAAAA8P//AAAAAAD///8AAAAA/////wAAAPD/////AADw//////8AAP///////wD/////////8P///////////////////w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico1\"\n    },\n    \"tile4\": {\n        \"data\": \"hwQQABAAAAD///////////D/////////AP////////8AAP///////wAA8P//////AAAA8P////8AAAAA/////wAAAAAA////AAAAAADw//8AAAAAAADw/wAAAAAAAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico2\"\n    },\n    \"tile5\": {\n        \"data\": \"hwQQABAAAAAAAP////8AAAD///////8A8P///////w/w////////D//////////////////////////////////////////////////////////////////////////////////////w////////D/D///////8PAP///////wAAAP////8AAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico3\"\n    },\n    \"nivel1\": {\n        \"id\": \"nivel1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA2MDAwMDAwMDYwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDYwMDAwMDAwMDAwMDAwMDAwMDAwMTAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDYwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMjAwMDQwMjA1MDAwMDAwMDAwMTAyMDMwMDAwMDAwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMjAwMDAwMDAwMDAwMDAwMDIwMDAwMDAwMDAwMDAwMDAyMDAwMDIwMDAwMDAwMDAwMjIwMDAwMDAwMDIwMDAwMjIyMjIyMjIyMjIyMjIyMg==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"myTiles.tile1\",\n            \"sprites.castle.tilePath2\",\n            \"myTiles.tile2\",\n            \"myTiles.tile3\",\n            \"myTiles.tile4\",\n            \"myTiles.tile5\"\n        ],\n        \"displayName\": \"nivel1\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}","tilemap.g.ts":"","pxt.json":"{\n    \"name\": \"Slope\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\",\n        \"physics.ts\",\n        \"tilemap.g.jres\",\n        \"tilemap.g.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1771768984137,"editorVersion":"4.0.7","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</variable><variable type=\"KIND_SpriteKind\" id=\"h2fWldLSRCoYR7b/28:I\">Player</variable><variable type=\"KIND_SpriteKind\" id=\"1@TpKk5NHrCNF:Ipk?}%\">Projectile</variable><variable type=\"KIND_SpriteKind\" id=\"`,Lwk,zf=cOgh~G*y+7B\">Food</variable><variable type=\"KIND_SpriteKind\" id=\"xkk+.wEPltA3+(OZw=9u\">Enemy</variable></variables><block type=\"keyonevent\" x=\"820\" y=\"-96\"><field name=\"button\">controller.A</field><field name=\"event\">ControllerButtonEvent.Pressed</field><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"spritehasobstacle\"><field name=\"direction\">CollisionDirection.Bottom</field><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value></block></value><statement name=\"DO0\"><block type=\"Sprite_blockCombine_change\"><field name=\"property\">Sprite.vy@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">-200</field></shadow></value></block></statement></block></statement></block><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"spritescreate\"><value name=\"img\"><shadow type=\"screen_image_picker\"><field name=\"img\">img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`</field><data>{\"commentRefs\":[],\"fieldData\":{\"img\":null}}</data></shadow></value><value name=\"kind\"><shadow type=\"spritekind\"><field name=\"MEMBER\">Player</field></shadow></value></block></value><next><block type=\"camerafollow\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><next><block type=\"set_current_tilemap\"><value name=\"tilemap\"><shadow type=\"tiles_tilemap_editor\"><field name=\"tilemap\">tilemap`nivel1`</field><data>{\"commentRefs\":[],\"fieldData\":{\"tilemap\":\"nivel1\"}}</data></shadow></value><next><block type=\"Sprite_blockCombine_set\"><field name=\"property\">Sprite.ay@set</field><value name=\"mySprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">350</field></shadow></value><next><block type=\"game_control_sprite\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"2\" _input_init=\"true\"></mutation><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value><value name=\"vx\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">100</field></shadow></value><value name=\"vy\"><shadow type=\"spriteSpeedPicker\"><field name=\"speed\">0</field></shadow></value><next><block type=\"gamesetbackgroundcolor\"><value name=\"color\"><shadow type=\"colorindexpicker\"><field name=\"index\">9</field></shadow></value><next><block type=\"physics_addPhysics\"><value name=\"sprite\"><block type=\"variables_get\"><field name=\"VAR\" id=\"#QXq7Rg*PiOyxDt!3]J%\">mySprite</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>","main.ts":"controller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    if (mySprite.isHittingTile(CollisionDirection.Bottom)) {\n        mySprite.vy += -200\n    }\n})\nlet mySprite: Sprite = null\nmySprite = sprites.create(img`\n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n    `, SpriteKind.Player)\nscene.cameraFollowSprite(mySprite)\ntiles.setCurrentTilemap(tilemap`nivel1`)\nmySprite.ay = 350\ncontroller.moveSprite(mySprite, 100, 0)\nscene.setBackgroundColor(9)\nphysics.addPhysics(mySprite)\n","README.md":" ","assets.json":"","physics.ts":"//% color=\"#268388\" icon=\"\\uf110\" block=\"Physics\"\nnamespace physics {\n    let _s: Sprite = null\n    let jumping = false\n\n    /**\n     * Adds 1x1 pixel physics to a sprite for ramps and slopes.\n     * RULE: Do not set red walls on the ramp tiles in the tilemap editor.\n     */\n    //% block=\"add physics to %sprite=variables_get(mySprite)\"\n    export function addPhysics(sprite: Sprite) {\n        _s = sprite\n\n        // JUMP LOGIC: When A is pressed, disable the ramp magnet for 300ms\n        controller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n            // Only jump if we are on the ground/ramp (vertical velocity near 0)\n            if (Math.abs(_s.vy) < 5) {\n                _s.vy = -150 // Jump force\n                jumping = true\n                // Run a parallel pause to re-enable ramp physics after takeoff\n                control.runInParallel(function () {\n                    pause(300)\n                    jumping = false\n                })\n            }\n        })\n    }\n\n    game.onUpdate(function () {\n        if (!_s || jumping) return\n\n        // 1. VELOCITY FILTER: If already moving up, don't snap to ground\n        if (_s.vy < 0) return\n\n        // 2. SYMMETRIC SCANNING (Left tip, Right tip, and Center)\n        let pointsX = [_s.left, _s.right, _s.x]\n        let bestY = -1\n\n        for (let i = 0; i < pointsX.length; i++) {\n            let x = pointsX[i]\n\n            // 3. ANTI-TELEPORT: Scan only 3px above feet\n            // This range is blind to 16px walls, preventing \"teleporting\" to the top.\n            for (let offset = -3; offset <= 4; offset++) {\n                let checkX = Math.floor(x)\n                let checkY = Math.floor(_s.bottom + offset)\n\n                let col = checkX >> 4\n                let row = checkY >> 4\n                let img = tiles.getTileAt(col, row)\n\n                if (img && img.width > 0) {\n                    let px = checkX % 16\n                    if (px < 0) px += 16\n                    let py = checkY % 16\n                    if (py < 0) py += 16\n\n                    // If pixel is not transparent (color != 0)\n                    if (img.getPixel(px, py) != 0) {\n                        let yGlobal = (row * 16) + py\n                        if (bestY == -1 || yGlobal < bestY) {\n                            bestY = yGlobal\n                        }\n                        break\n                    }\n                }\n            }\n        }\n\n        // 4. PRECISION ANCHORING (Anti-sinking)\n        if (bestY != -1 && _s.bottom >= bestY - 4) {\n            _s.bottom = bestY\n\n            // Neutralize gravity's downward velocity\n            if (_s.vy > 0) _s.vy = 0\n\n            // Micro-adjustment to stay on top of the pixel\n            _s.y -= 0.15\n        }\n    })\n}\n","tilemap.g.jres":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile7\": {\n        \"data\": \"hwQQABAAAAAAAAAAAPD//wAAAAAA////AAAAAAD///8AAAAA8P///wAAAADw//8PAAAAAP///w8AAAAA////AAAAAPD///8AAAAA8P//DwAAAAD///8AAAAAAP///wAAAADw//8PAAAAAPD//w8AAAAA////AAAAAAD///8AAAAA8P//DwAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico5\"\n    },\n    \"tile8\": {\n        \"data\": \"hwQQABAAAAAA8P//DwAAAAD///8PAAAAAP///wAAAADw////AAAAAPD//w8AAAAA////DwAAAAD///8AAAAAAP///wAAAAAA//8PAAAAAAD//wAAAAAAAP//AAAAAAAA/w8AAAAAAAD/DwAAAAAAAP8AAAAAAAAA/wAAAAAAAAAPAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico6\"\n    },\n    \"tile9\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAPAAAAAAAAAA/wAAAAAAAAD/AAAAAAAA8P8AAAAAAADw/wAAAAAAAP//AAAAAAAA//8AAAAAAPD//w==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico7\"\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAAAAAAAB8R8QAAAADwHRERAAAAAPAdEREAAA8A3x0REQDw8ADfHRERAPDw8N0dERHwAA/w3R0REQ8PAN/dHRERDw8A390dERHwAADf3R0REQAAAN/dHRERAAAA390dEREAAADf3R0REQAAAN/dHRERAAAA390dEREAAADf3R0REQ==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico\"\n    },\n    \"tile2\": {\n        \"data\": \"hwQQABAAAAAAAADf3R0REQAAAN/dHRERAAAA390dEREAAADf/R8REQAAAN/f/RERAAAA39/9EREAAADf/R8REQAAAP//HxERAADwDwAQEREAAP8AABAREQDwDwAAEBERAP8AAAAQERHwDwAAAAAREf8AAAAAABARDwAAAAAAABEAAAAAAAAA8A==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico0\"\n    },\n    \"tile3\": {\n        \"data\": \"hwQQABAAAAD/AAAAAAAAAPH/AAAAAAAAEfH/AAAAAAAREfEPAAAAABEREf8AAAAAERER8Q8AAAARERER/wAAABERERHxDwAAERERERH/AAAREREREfEPABERERER8Q8AERERERHxDwAREREREfEPABERERER8Q8AERERERHxDwAREREREfEPAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico1\"\n    },\n    \"tile4\": {\n        \"data\": \"hwQQABAAAAAREREREfEPABERERER8Q8AERERERHxDwAREREREfEPABERERER8Q8AERERERHxDwAREREREfEPABERERER/wAAEREREfEPAAARERER/wAAABEREfEPAAAAERER/wAAAAAREfEPAAAAABHx/wAAAAAA8f8AAAAAAAD/AAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico2\"\n    },\n    \"tile5\": {\n        \"data\": \"hwQQABAAAAAAAP///w8AAAD/sLu7uw8A8LALAAAAuwDwCwAAAADwCw8LAAAAAAALvwAAAAAAAL+/AAAAAAAAv78AAAAAAAC/vwAAAAAAAL+/AAAAAAAAv78AAAAAAAC/sAAAAAAA8LDwCwAAAADwCwD7AAAA8A8LALD7//8PuwAAALC7u7sAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico3\"\n    },\n    \"tile6\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///w8AAADwsLu7uwAAAPALAADwCwAA8AsAAPALAADwCwAA8AsAAPALAADwCwAA8AsAAPALAADwCwAA8AsAAAD7//8PCwAAALC7u7sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico4\"\n    },\n    \"tile10\": {\n        \"data\": \"hwQQABAAAAD//w8AAAAAAI+IDwAAAAAAj4gPAAAAAACPiA8AAAAAAP//DwAAAAAAj4gPAAAAAACPiA8AAAAAAI+IDwAAAAAA//8PAAAAAACPiA8AAAAAAI+IDwAAAAAAj4gPAAAAAAD//w8AAAAAAI+IDwAAAAAAj4gPAAAAAAD//w8AAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"miMosaico8\"\n    },\n    \"nivel1\": {\n        \"id\": \"nivel1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxOTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBiMDAwMDAwMDAwMDAwMDAwYjAwMDAwMDBiMDAwMDBiMDAwMDBhMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDkwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA0MDIwMzAwMDAwMDAwMDUwNjAwMDAwMDBhMDAwMDAwMDAwMDAwMDAwMDAwMDAwNDAyMDMwMDAwMDAwMDAwMDAwNzA4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQwMjAzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDIwMzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwYjBiMGIwYjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGIwYjBiMGIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMg==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"sprites.castle.tilePath2\",\n            \"myTiles.tile7\",\n            \"myTiles.tile8\",\n            \"myTiles.tile9\",\n            \"myTiles.tile1\",\n            \"myTiles.tile2\",\n            \"myTiles.tile3\",\n            \"myTiles.tile4\",\n            \"myTiles.tile5\",\n            \"myTiles.tile6\",\n            \"myTiles.tile10\"\n        ],\n        \"displayName\": \"nivel1\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}","tilemap.g.ts":"","pxt.json":"{\n    \"name\": \"Slope\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"assets.json\",\n        \"physics.ts\",\n        \"tilemap.g.jres\",\n        \"tilemap.g.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}}],"shares":[],"lastSaveTime":1771768984153}